# Лабораторная работа №2 по функциональной схемотехнике «Разработка аппаратных ускорителей математических вычислений»

Выполнили: Акатьев Никита, Трушкина Вера гр. P33111

[Лабораторная работа №1](lab1/README.md)

## Содержание
[Текст задания](#текст-задания) \
[Описание функции](#описание-функции) \
[Исходный код](#исходный-код)

## Текст задания

1. Разработайте и опишите на Verilog HDL схему, вычисляющую значение функции в соответствии с заданными ограничениями согласно варианту задания.
2. Определите область допустимых значений функции.
3. Разработайте тестовое окружение для разработанной схемы.
4. Проведите моделирование работы схемы и определите время вычисления результата. Схема должна тактироваться от сигнала с частотой 100 МГц.

**Функция**: `a^3 + ab` \
**Ограничения**: 2 сумматора и 1 умножитель

## Описание функции

### Пошаговые операции:
1. `a^2 = a * a`
2. `a^3 = a^2 * a`
3. `ab = a * b`
4. `Результат = a^3 + ab`

Если `a` и `b` - 8-разрядные беззнаковые числа, то для хранения результата требуется 24 разряда.

### Конечные автоматы для модулей:

**Модуль умножения** \
![Конечный автомат модуля умножения](graphics/mult-fsm.png)

`READY` - схема простаивает, ожидает новые данные для обработки. Когда в этом состоянии приходит сигнал `enable`, схема переходит в `WORK` и подготавливает входные и выходные данные для обработки модулем.

`WORK` - схема вычисляет произведение входных аргументов. На каждом шаге, текущий результат сдвигается вправо и к нему прибавляется значение первого операнда, если соответствующий бит второго операнда равен 1. Операция повторяется 8 раз, после чего схема возвращается в состояние `READY` и ожидает следующих данных.

**Основной модуль** \
![Конечный автомат основного модуля](graphics/main-fsm.png)

`READY` - схема простаивает, ожидает аргументы `a` и `b`. Когда в этом состоянии приходит сигнал `enable`, схема переходит в `SQUARE` и параллельно запускает модуль умножения, передавая ему два операнда - `a` и `a`.

`SQUARE` - схема ожидает окончания работы модуля умножения. Когда он закончил подсчет `a^2`, схема переходит в `CUBE` и запускает модуль умножения снова, передавая в него операнды `a^2` и `a`.

`CUBE` - схема ожидает окончания работы модуля умножения. Когда он закончил подсчет `a^3`, схема переходит в `MUL` и запускает модуль умножения снова, передавая в него операнды `a` и `b`.

`MUL` - схема ожидает окончания работы модуля умножения. После этого, схема складывает `a^3` и `ab`, полученные на двух предыдущих шагах, и возвращается в состояние `READY`, ожидая следующих данных.

### Время вычисления результата:

Значение функции будет получено ровно за 30 тактов - модуль умножения требует 9 тактов + три такта для переходов между разными состояниями. При тактовой частоте 100 МГц имеем длительность такта 10 нс => время вычисления результата - 300 нс.

## Исходный код

[mult.v](mult.v) - модуль умножения, [mult_tb.v](mult_tb.v) - его тестовое окружение для симуляций и отладки

[main_function.v](mult.v) - основной модуль, [main_function_tb.v](mult_tb.v) - его тестовое окружение для симуляций и отладки
